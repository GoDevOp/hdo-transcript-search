#!/usr/bin/env ruby

require 'optparse'

options = {
  elasticsearch_url: 'http://localhost:9200',
  data_dir: File.expand_path('./data'),
  sessions: [
    '2008-2009',
    '2009-2010',
    '2010-2011',
    '2011-2012',
    '2013-2014',
    '2014-2015',
    '2015-2016'
  ]
}

parser = OptionParser.new do |opt|
  opt.on('-e', '--elasticsearch-url URL', "URL to elasticsearch server, default: #{options[:elasticsearch_url]}") { |url| options[:elasticsearch_url] = url }
  opt.on('-d', '--data-dir PATH', "Data dir to cache downloads, default: #{options[:data_dir]}") { |dir| options[:data_dir] = dir }
  opt.on('-s', '--sessions SESSIONS', "Comma-separated list of sessions, default: #{options[:sessions].join(',')}") { |sessions| options[:sessions] = sessions.split(',') }
  opt.on('-h', '--help', "You're looking at it.") { puts opt; exit 0; }
end

parser.parse!(ARGV)

require 'hdo-transcript-indexer'
Hdo::Transcript::Indexer.new(options).execute
